<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Ch6 - Partitioning - Dendron</title> <link rel="shortcut icon" href="http://localhost:4000/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="http://localhost:4000/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="http://localhost:4000/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="http://localhost:4000/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.6.1 --> <title>Ch6 - Partitioning | Dendron</title> <meta name="generator" content="Jekyll v3.9.0" /> <meta property="og:title" content="Ch6 - Partitioning" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Dendron is a local-first, markdown based, hierarchical note taking tool. It is meant to help you create, organize, and collaborate on knowledge bases of any size." /> <meta property="og:description" content="Dendron is a local-first, markdown based, hierarchical note taking tool. It is meant to help you create, organize, and collaborate on knowledge bases of any size." /> <link rel="canonical" href="http://localhost:4000/notes/c61cfa31-05a8-47de-897d-0fbd0a884e69.html" /> <meta property="og:url" content="http://localhost:4000/notes/c61cfa31-05a8-47de-897d-0fbd0a884e69.html" /> <meta property="og:site_name" content="Dendron" /> <meta property="og:image" content="http://localhost:4000/assets/images/logo.png" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:image" content="http://localhost:4000/assets/images/logo.png" /> <meta property="twitter:title" content="Ch6 - Partitioning" /> <meta name="twitter:site" content="@dendronhq" /> <meta name="twitter:creator" content="@dendronhq" /> <script type="application/ld+json"> {"url":"http://localhost:4000/notes/c61cfa31-05a8-47de-897d-0fbd0a884e69.html","image":"http://localhost:4000/assets/images/logo.png","headline":"Ch6 - Partitioning","description":"Dendron is a local-first, markdown based, hierarchical note taking tool. It is meant to help you create, organize, and collaborate on knowledge bases of any size.","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/assets/images/logo.png"}},"@type":"WebPage","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="http://localhost:4000/" class="site-title lh-tight"> <div class="site-logo"></div> </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"><ul class="nav-list"><li class="nav-list-item active"><a href="http://localhost:4000/" class="nav-list-link active">Root</a><ul class="nav-list"><li class="nav-list-item active"><a href="" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/notes/d088ab77-c2f6-4f7a-be4a-7597b00daff0.html" class="nav-list-link active">Book</a><ul class="nav-list"><li class="nav-list-item active"><a href="" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/notes/ede45f4d-8d30-42a9-bd27-f1b3ba37d6e0.html" class="nav-list-link active">Tech</a><ul class="nav-list"><li class="nav-list-item active"><a href="" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/notes/a42eba1d-b978-4cdc-9160-1f3e9c7cf025.html" class="nav-list-link active">Data-intensive-applications</a><ul class="nav-list"><li class="nav-list-item"><a href="http://localhost:4000/notes/e22dd5a3-f940-4548-b1d7-22a26b5386ce.html" class="nav-list-link">Ch4 - Encoding and evolution</a></li><li class="nav-list-item"><a href="http://localhost:4000/notes/28cfed31-0166-4784-a7d6-c76d3fcd269e.html" class="nav-list-link">Ch5 - Replication</a></li><li class="nav-list-item active"><a href="http://localhost:4000/notes/c61cfa31-05a8-47de-897d-0fbd0a884e69.html" class="nav-list-link active">Ch6 - Partitioning</a></li><li class="nav-list-item"><a href="http://localhost:4000/notes/603d252d-91ec-4f35-950e-26211cd5112a.html" class="nav-list-link">Ch7 - Transactions</a></li></ul></li></ul></li></ul></li></ul></li></ul></nav> <footer class="site-footer"> ðŸŒ± with ðŸ’• using <a href="https://www.dendron.so/"> Dendron ðŸŒ² </a> </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Dendron" aria-label="Search Dendron" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"><li class="breadcrumb-nav-list-item"><a href="http://localhost:4000/">Root</a></li><li class="breadcrumb-nav-list-item"><a href="http://localhost:4000/notes/d088ab77-c2f6-4f7a-be4a-7597b00daff0.html">Book</a></li><li class="breadcrumb-nav-list-item"><a href="http://localhost:4000/notes/ede45f4d-8d30-42a9-bd27-f1b3ba37d6e0.html">Tech</a></li><li class="breadcrumb-nav-list-item"><a href="http://localhost:4000/notes/a42eba1d-b978-4cdc-9160-1f3e9c7cf025.html">Data-intensive-applications</a></li><li class="breadcrumb-nav-list-item">Ch6 - Partitioning</li></ol> </nav> <div id="main-content" class="main-content" role="main"> <ul> <li>Partitioned databases were pioneered in the 1980s by products such as Teradata, rediscvoered by noSQL</li> </ul> <h2 id="partitioning-by-key-range"> <a href="#partitioning-by-key-range" aria-labelledby="partitioning-by-key-range" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Partitioning by Key Range </h2> <ul> <li>used by BigTable, open source equivalent HBase, MongoDB before v2.4</li> <li>sorted in each partition: range scanes are easy</li> <li>con: hot spots</li> </ul> <h2 id="partition-by-hash-key"> <a href="#partition-by-hash-key" aria-labelledby="partition-by-hash-key" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> partition by hash key </h2> <ul> <li>choice of hash key: <ul> <li>Cassandra and MongoDB use MD5, Vodemort uses Fowlerâ€“ Nollâ€“Vo function.</li> <li>MurmurHash - non-cryptographic but lightweight</li> <li>built-in Java hash function is bad, because same key -&gt; different hash <ul> <li>itâ€™s built for in memory hash tables and the behavior is <a href="http://martin.kleppmann.com/2012/06/18/java-hashcode-unsafe-for-distributed-systems.html">a safety mechanism to prevent collding hash attacks</a></li> </ul> </li> </ul> </li> <li>Consistent Hashing <ul> <li>great for caches</li> <li>does not work great for DBs</li> </ul> </li> <li>range query difficult - Cassandra and DynamoDB uses hash + sort ey</li> <li>hotspot relief: application level - route writes to multiple keys: key_random_num</li> </ul> <h2 id="secondary-indexes"> <a href="#secondary-indexes" aria-labelledby="secondary-indexes" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Secondary Indexes </h2> <ul> <li>local index - scatter writes, gather for eads <ul> <li>Used by MongoDB, Riak, Cassandra, Elasticsearch, SolrCloud, and VoltDB</li> </ul> </li> <li>global index <ul> <li>write reaches multiple partitions - distributed transaction or async update</li> </ul> </li> </ul> <h2 id="rebalancing-partitions"> <a href="#rebalancing-partitions" aria-labelledby="rebalancing-partitions" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Rebalancing Partitions </h2> <ol> <li>Fixed number of partitions <ul> <li>more partitions than nodes</li> <li>when new node join, steal partitions from others</li> <li>Used in Riak, Elasticsearch, Couchbase, and Voldemort</li> <li>hard to pick the right number of partitions</li> </ul> </li> <li>parition spliting and merging</li> <li># of partition proportionally to nodes <ul> <li>when a new node joins the cluster, it randomly chooses a fixed number of existing partitions to split, and then takes ownership of half of each partition</li> <li>used by Cassandra</li> </ul> </li> </ol> <ul> <li>auto vs manual rebalancing <ul> <li>full automation can be dangerous in combination with automatic failure detection</li> </ul> </li> </ul> <h2 id="request-routing"> <a href="#request-routing" aria-labelledby="request-routing" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Request Routing </h2> <ul> <li>require consensus <ul> <li>use zookeeper - HBase, SolrCloud, Kafka, Espresso</li> <li>gossip - Cassandra and Riak</li> <li>no autobalancing, routing tier - couchbase</li> </ul> </li> </ul> <hr> <footer> <p class="text-small text-grey-dk-000 mb-0"></p> </footer> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
